(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b5307ba"],{"159b":function(t,e,a){var i=a("da84"),o=a("fdbc"),n=a("17c2"),r=a("9112");for(var s in o){var c=i[s],l=c&&c.prototype;if(l&&l.forEach!==n)try{r(l,"forEach",n)}catch(u){l.forEach=n}}},"17c2":function(t,e,a){"use strict";var i=a("b727").forEach,o=a("a640"),n=a("ae40"),r=o("forEach"),s=n("forEach");t.exports=r&&s?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},4160:function(t,e,a){"use strict";var i=a("23e7"),o=a("17c2");i({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},"56c7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"homePage"}},[a("div",{staticClass:"left"},[a("div",{staticClass:"usage-rate shadow"},[a("p",{staticClass:"title"},[t._v("项目使用率")]),a("div",{staticClass:"radio"},[a("el-radio-group",{on:{change:t.getUsageRateData},model:{value:t.usageRateRadio,callback:function(e){t.usageRateRadio=e},expression:"usageRateRadio"}},[a("el-radio",{attrs:{label:1}},[t._v("本周")]),a("el-radio",{attrs:{label:2}},[t._v("本月")])],1)],1),a("div",{ref:"usageRate",staticClass:"usage-rate-chart"}),a("div",{staticClass:"project"},[a("p",{staticClass:"on"},[t._v("使用项目："+t._s(t.usageOn))]),a("p",{staticClass:"off"},[t._v("未使用项目："+t._s(t.usageOff))])])]),a("div",{staticClass:"troubleshoot shadow"},[a("p",{staticClass:"title"},[t._v("排查情况")]),a("div",{staticClass:"troubleshoot-item"},[a("div",{staticClass:"top"},[a("div",{staticClass:"total"},[a("p",[t._v("检查总数 "+t._s(t.company.examine))]),a("p",[t._v("隐患总数 "+t._s(t.company.danger))]),a("p",[t._v("重大隐患 "+t._s(t.company.great))])]),a("div",{staticClass:"percent"},[a("p",{staticClass:"name"},[t._v("企业")]),a("p",{staticClass:"percent-num"},[t._v(t._s(t.company.reform)+" %")]),a("p",{staticClass:"reform"},[t._v("整改率")])])]),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:parseFloat(t.company.reform)}}),a("div",{staticClass:"compare"},[a("span",[t._v("周同比"),a("i",{staticClass:"el-icon-caret-top"}),a("span",[t._v(t._s(t.company.week)+"%")])]),a("span",[t._v("日环比"),a("i",{staticClass:"el-icon-caret-bottom"}),a("span",[t._v(t._s(t.company.month)+"%")])])])],1),a("div",{staticClass:"troubleshoot-item"},[a("div",{staticClass:"top"},[a("div",{staticClass:"total"},[a("p",[t._v("检查总数 "+t._s(t.project.examine))]),a("p",[t._v("隐患总数 "+t._s(t.project.danger))]),a("p",[t._v("重大隐患 "+t._s(t.project.great))])]),a("div",{staticClass:"percent"},[a("p",{staticClass:"name"},[t._v("项目")]),a("p",{staticClass:"percent-num"},[t._v(t._s(t.project.reform)+" %")]),a("p",{staticClass:"reform"},[t._v("整改率")])])]),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:parseFloat(t.project.reform)}}),a("div",{staticClass:"compare"},[a("span",[t._v("周同比"),a("i",{staticClass:"el-icon-caret-top"}),a("span",[t._v(t._s(t.project.week)+"%")])]),a("span",[t._v("日环比"),a("i",{staticClass:"el-icon-caret-bottom"}),a("span",[t._v(t._s(t.project.month)+"%")])])])],1)]),a("div",{staticClass:"ranking shadow"},[a("p",{staticClass:"title"},[t._v("在施重大风险项目排行")]),a("div",{staticClass:"radio"},[a("el-radio-group",{on:{change:t.getRiskData},model:{value:t.riskRadio,callback:function(e){t.riskRadio=e},expression:"riskRadio"}},[a("el-radio",{attrs:{label:1}},[t._v("本周")]),a("el-radio",{attrs:{label:2}},[t._v("本月")])],1)],1),a("div",{ref:"risk",staticClass:"risk-chart"})])]),a("div",{staticClass:"center"},[a("div",{staticClass:"shadow",attrs:{id:"map"}}),a("div",{staticClass:"trend shadow"},[a("p",{staticClass:"title"},[t._v("风险走势图")]),a("div",{staticClass:"radio"},[a("el-radio-group",{on:{change:t.getTrendData},model:{value:t.trendRadio,callback:function(e){t.trendRadio=e},expression:"trendRadio"}},[a("el-radio",{attrs:{label:1}},[t._v("本周")]),a("el-radio",{attrs:{label:2}},[t._v("本月")])],1)],1),a("div",{ref:"trend",staticClass:"trend-chart"})])]),a("div",{staticClass:"right"},[a("div",{staticClass:"safety shadow"},[a("p",{staticClass:"title"},[t._v("安全管理预警")]),a("div",{ref:"scrollWrap",staticClass:"warning"},[a("div",{ref:"scroll",staticClass:"scroll"},t._l(t.warningList,(function(e){return a("p",[t._v(t._s(e.name)),a("span",[t._v(t._s(e.num))])])})),0)])]),a("div",{staticClass:"category shadow"},[a("p",{staticClass:"title"},[t._v("隐患类别统计")]),a("div",{staticClass:"radio"},[a("el-radio-group",{on:{change:t.getCategoryData},model:{value:t.categoryRadio,callback:function(e){t.categoryRadio=e},expression:"categoryRadio"}},[a("el-radio",{attrs:{label:1}},[t._v("本周")]),a("el-radio",{attrs:{label:2}},[t._v("本月")])],1)],1),a("div",{ref:"category",staticClass:"category-chart"})])])])},o=[],n=(a("99af"),a("4de4"),a("4160"),a("d81d"),a("13d5"),a("b0c0"),a("b680"),a("4d90"),a("9911"),a("159b"),a("d4ec")),r=a("bee2"),s=a("262e"),c=a("2caf"),l=a("9ab4"),u=a("60a3"),d=a("9006"),p=a("0613"),g=a("350b"),h=a("7fc3"),f=function(t){Object(s["a"])(a,t);var e=Object(c["a"])(a);function a(t){var i;return Object(n["a"])(this,a),i=e.call(this,t),i.url=h["a"].homePage,i}return Object(r["a"])(a,[{key:"getCategoryData",value:function(t){return g["a"].post(this.url.categoryData,t)}},{key:"getRiskData",value:function(t){return g["a"].post(this.url.riskData,t)}},{key:"getTrendData",value:function(t){return g["a"].post(this.url.trendData,t)}},{key:"getUsageRateData",value:function(t){return g["a"].post(this.url.usageRateData,t)}},{key:"getTroubleshoot",value:function(t){return g["a"].post(this.url.troubleshoot,t)}},{key:"getMap",value:function(t){return g["a"].post(this.url.map,t)}},{key:"getWarning",value:function(t){return g["a"].post(this.url.warning,t)}}]),a}(d["d"]);Object(l["a"])([d["a"]],f.prototype,"getCategoryData",null),Object(l["a"])([d["a"]],f.prototype,"getRiskData",null),Object(l["a"])([d["a"]],f.prototype,"getTrendData",null),Object(l["a"])([d["a"]],f.prototype,"getUsageRateData",null),Object(l["a"])([d["a"]],f.prototype,"getTroubleshoot",null),Object(l["a"])([d["a"]],f.prototype,"getMap",null),Object(l["a"])([d["a"]],f.prototype,"getWarning",null),f=Object(l["a"])([Object(d["b"])({namespaced:!0,stateFactory:!0,dynamic:!0,name:"HomePageStore",store:p["a"]})],f);var v=f,m=a("313e"),y=a.n(m),b=a("c328"),k=function(t){Object(s["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(n["a"])(this,a),t=e.call(this),t.center=[114.057939,22.543527],t.usageRateRadio=1,t.categoryRadio=1,t.riskRadio=1,t.trendRadio=1,t.usageOn=0,t.usageOff=0,t.company={examine:0,danger:0,great:0,week:0,month:0,reform:0},t.project={examine:0,danger:0,great:0,week:0,month:0,reform:0},t.warningList=[{name:"最近七天未进行隐患排查的项目数",num:0,link:"weekUnCheckCount"},{name:"隐患整改率低于50%项目数",num:0,link:"rectificationTotal"},{name:"最近一个月未履行检查的公司数",num:0,link:"monthUnCheckCount"},{name:"未整改重大隐患数",num:0,link:"unReformDangerTotal"},{name:"超期未复查重大隐患数",num:0,link:"unReviewHiddenDangerCount"}],t.now=new Date,t.nowTime=new b["a"](t.now).get(),t.weekAgo=new b["a"](new Date(t.now.getTime()-864e5*(t.now.getDay()?t.now.getDay()-1:6))).get(),t.monthAgo=new b["a"](new Date(t.now.getTime()-864e5*(t.now.getDate()-1))).get(),t.projectId=sessionStorage.getItem("seeProjectId"),t.store=Object(d["e"])(v),t}return Object(r["a"])(a,[{key:"mounted",value:function(){this.map=new AMap.Map("map",{zoom:11,center:this.center,viewMode:"3D",mapStyle:"amap://styles/fresh"}),this.getMap(),this.getUsageRateData(),this.getRiskData(),this.getTrendData(),this.getCategoryData(),this.getTroubleshoot(),this.getWarning()}},{key:"getMap",value:function(){var t=this;this.store.getMap({projectId:this.projectId}).then((function(e){if(0===e.code){var a=[];e.data.forEach((function(e,i){if(e.longitude&&e.latitude){var o=[e.longitude,e.latitude];0===i&&t.map.setCenter(o);var n=new AMap.Marker({position:o}),r=new AMap.InfoWindow({anchor:"bottom-center",content:e.name,offset:new AMap.Pixel(0,-30)});n.on("mouseover",(function(){r.open(t.map,o)})),n.on("mouseout",(function(){r.close()})),a.push(n)}})),t.map.add(a)}}))}},{key:"getUsageRateData",value:function(){var t=this,e={projectId:this.projectId,startTime:1===this.usageRateRadio?this.weekAgo:this.monthAgo,endTime:this.nowTime};this.store.getUsageRateData(e).then((function(e){if(0===e.code){t.usageOn=e.data.use,t.usageOff=e.data.unUse;var a=[{name:"使用项目",value:e.data.use},{name:"未使用项目",value:e.data.unUse}];t.getUsageRate(a)}}))}},{key:"getUsageRate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t&&t.length?t:[{name:"无数据",value:0}];var e=t.reduce((function(t,e){return t+e.value}),0),a=y.a.init(this.$refs.usageRate);a.setOption({series:[{type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,color:["#00b577","#c0e8e7"],label:{show:!1,position:"center",formatter:function(t){return"".concat(t.name,":\n").concat(e?(t.value/e*100).toFixed(2):0,"%")}},emphasis:{label:{show:!0,fontSize:"15"}},labelLine:{show:!1},itemStyle:{normal:{borderColor:"#fff",borderWidth:t.length>1?2:0}},data:t}]}),window.onresize=function(){a.resize()}}},{key:"getRiskData",value:function(){var t=this,e={projectId:this.projectId,startTime:1===this.riskRadio?this.weekAgo:this.monthAgo,endTime:this.nowTime};this.store.getRiskData(e).then((function(e){if(0===e.code){var a=e.data.map((function(t){return{name:t.name,value:t.significanTiskTotal}}));t.getRisk(a)}}))}},{key:"getRisk",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t&&t.length?t:[{name:"无数据",value:0},{name:"无数据",value:0},{name:"无数据",value:0}];var e=t.map((function(t){return t.name})),a=t.map((function(t){return t.value})),i=y.a.init(this.$refs.risk);i.setOption({title:{text:"风险数量",textStyle:{fontWeight:500,fontSize:14},left:10,top:10},tooltip:{trigger:"item"},grid:{containLabel:!0,bottom:10,left:20,right:10},color:"#3BA1FF",xAxis:{type:"category",axisTick:{show:!1},data:e,axisLabel:{formatter:function(t){var e="",a=6,i=3,o=Math.ceil(a/i);if(a>i)for(var n=0;n<o;n++){var r="",s=n*i,c=s+i;r=n===o-1?t.substring(s,a):t.substring(s,c)+"\n",e+=r}else e=t;return e}}},yAxis:{type:"value",axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{type:"dotted"}}},series:{data:a,type:"bar",barMaxWidth:20,itemStyle:{normal:{barBorderRadius:[10,10,0,0]}}}}),window.onresize=function(){i.resize()}}},{key:"getTrendData",value:function(){var t=this,e={projectId:this.projectId,startTime:1===this.trendRadio?this.weekAgo:this.monthAgo,endTime:this.nowTime};this.store.getTrendData(e).then((function(e){if(0===e.code){var a=e.data.map((function(t){return{name:t.createOn,ordinary:t.riskTotal-t.significanTiskTotal,great:t.significanTiskTotal}}));t.getTrend(a)}}))}},{key:"getTrend",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t&&t.length?t:[{name:"无数据",ordinary:0,great:0},{name:"无数据",ordinary:0,great:0},{name:"无数据",ordinary:0,great:0}];var e=t.map((function(t){return t.name})),a=t.map((function(t){return t.ordinary})),i=t.map((function(t){return t.great})),o=y.a.init(this.$refs.trend);o.setOption({tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{containLabel:!0,top:20,bottom:10,left:20,right:10},color:["#61D182","#2999EB"],xAxis:{type:"category",axisTick:{show:!1},data:e},yAxis:{type:"value",axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{type:"dotted"}}},series:[{name:"一般隐患",data:a,type:"line",smooth:!0},{name:"重大隐患",data:i,type:"line",smooth:!0}]}),window.onresize=function(){o.resize()}}},{key:"getCategoryData",value:function(){var t=this,e={projectId:this.projectId,startTime:1===this.categoryRadio?this.weekAgo:this.monthAgo,endTime:this.nowTime};this.store.getCategoryData(e).then((function(e){if(0===e.code){var a=e.data.map((function(t){return{name:t.inspectTask,value:t.count}}));t.getCategory(a)}}))}},{key:"getCategory",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t&&t.length?t:[{name:"无数据",value:0}];var e=t.reduce((function(t,e){return t+e.value}),0),a=t.map((function(t){return t.name})),i=y.a.init(this.$refs.category);i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"center",bottom:20,formatter:function(a){var i=t.filter((function(t){return t.name===a}))[0],o=e?(i.value/e*100).toFixed(2):0,n=a.length<6?a.padStart(5,"一"):a.substring(0,5);return" ".concat(n," | ").concat(o<10&&e?"0"+o:o,"%   ").concat(i.value)},data:a},color:["#36CBCB","#975FE4","#F04864","#FAD337","#4ECB73","#3BA0FF"],series:[{type:"pie",radius:["50%","70%"],center:["50%","35%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},labelLine:{show:!1},itemStyle:{normal:{borderColor:"#fff",borderWidth:t.length>1?2:0}},data:t}]}),window.onresize=function(){i.resize()}}},{key:"getScroll",value:function(){var t=this.$refs.scroll.clientHeight,e=this.$refs.scrollWrap.scrollTop;if(e<t)return this.$refs.scrollWrap.scrollTop=e+1,void requestAnimationFrame(this.getScroll);this.$refs.scrollWrap.scrollTop=0,this.getScroll()}},{key:"getTroubleshoot",value:function(){var t=this,e={projectId:this.projectId};this.store.getTroubleshoot(e).then((function(e){if(0===e.code){var a=e.data;t.company={examine:a.companyExamineTotal,danger:a.companyRiskTotaL,great:a.companySignificantRiskTotal,week:a.companyWeekRatio,month:a.companyDayliyRatio,reform:a.companyRiskRate.toFixed(2)},t.project={examine:a.projectExamineTotal,danger:a.projectRiskTotal,great:a.projectSignificantRiskTotal,week:a.projectWeekRatio,month:a.projectDayliyRatio,reform:a.projectRiskRate.toFixed(2)}}}))}},{key:"getWarning",value:function(){var t=this;this.store.getWarning({projectId:this.projectId}).then((function(e){if(0===e.code){var a=e.data;t.warningList.forEach((function(t){t.num=a[t.link]}))}}))}}]),a}(u["b"]);k=Object(l["a"])([Object(u["a"])({})],k);var w=k,C=w,R=(a("a112"),a("2877")),_=Object(R["a"])(C,i,o,!1,null,null,null);e["default"]=_.exports},"857a":function(t,e,a){var i=a("1d80"),o=/"/g;t.exports=function(t,e,a,n){var r=String(i(t)),s="<"+e;return""!==a&&(s+=" "+a+'="'+String(n).replace(o,"&quot;")+'"'),s+">"+r+"</"+e+">"}},9911:function(t,e,a){"use strict";var i=a("23e7"),o=a("857a"),n=a("af03");i({target:"String",proto:!0,forced:n("link")},{link:function(t){return o(this,"a","href",t)}})},a112:function(t,e,a){"use strict";var i=a("ab10"),o=a.n(i);o.a},ab10:function(t,e,a){},af03:function(t,e,a){var i=a("d039");t.exports=function(t){return i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}}}]);
//# sourceMappingURL=chunk-6b5307ba.1968b625.js.map